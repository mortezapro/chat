# راهنمای تست قابلیت‌های پیام‌رسان

## قابلیت‌های پیاده‌سازی شده

### ✅ 1. پیام‌های صوتی
- [x] ضبط پیام صوتی
- [x] پخش پیش‌نمایش قبل از ارسال
- [x] ارسال پیام صوتی
- [x] پخش پیام‌های صوتی دریافتی
- [x] کنترل پیشرفت پخش

**تست:**
1. روی آیکون میکروفون کلیک کنید
2. ضبط را شروع کنید
3. پیام را متوقف کنید
4. پیش‌نمایش را پخش کنید
5. پیام را ارسال کنید

### ✅ 2. مدیریت گروه و ادمین
- [x] ادمین کردن کاربران
- [x] حذف از ادمین‌ها
- [x] تنظیمات امنیتی گروه
- [x] مدیریت اعضا

**تست:**
1. به تنظیمات گروه بروید
2. یک کاربر را ادمین کنید
3. تنظیمات امنیتی را تغییر دهید
4. یک عضو را حذف کنید

### ✅ 3. نوتیفیکیشن‌ها
- [x] درخواست مجوز نوتیفیکیشن
- [x] نمایش نوتیفیکیشن برای پیام‌های جدید
- [x] کلیک روی نوتیفیکیشن برای باز کردن چت

**تست:**
1. مجوز نوتیفیکیشن را بدهید
2. یک پیام جدید دریافت کنید (در تب دیگر)
3. روی نوتیفیکیشن کلیک کنید

### ✅ 4. نمایش کاربران در حال تایپ
- [x] نمایش real-time تایپ
- [x] نمایش آواتار کاربران
- [x] انیمیشن تایپ

**تست:**
1. در یک چت شروع به تایپ کنید
2. کاربر دیگر باید "در حال تایپ..." را ببیند

### ✅ 5. استوری
- [x] ایجاد استوری
- [x] نمایش استوری‌ها
- [x] بازدید و واکنش
- [x] منقضی شدن خودکار

**تست:**
1. روی "استوری شما" کلیک کنید
2. یک تصویر یا ویدیو انتخاب کنید
3. استوری را مشاهده کنید
4. به استوری واکنش دهید

### ✅ 6. مسدود کردن کاربران
- [x] مسدود کردن کاربر
- [x] خارج کردن از مسدودی
- [x] لیست کاربران مسدود شده

**تست:**
1. به پروفایل کاربر بروید
2. کاربر را مسدود کنید
3. بررسی کنید که پیامی دریافت نمی‌کنید

### ✅ 7. آرشیو و بی‌صدا کردن چت
- [x] آرشیو کردن چت
- [x] خارج کردن از آرشیو
- [x] بی‌صدا کردن چت
- [x] لغو بی‌صدا

**تست:**
1. از منوی چت، "آرشیو" را انتخاب کنید
2. چت را بی‌صدا کنید
3. بررسی کنید که نوتیفیکیشن دریافت نمی‌کنید

### ✅ 8. لینک دعوت به گروه
- [x] ایجاد لینک دعوت
- [x] پیوستن از طریق لینک
- [x] لغو لینک

**تست:**
1. در تنظیمات گروه، "ایجاد لینک دعوت" را انتخاب کنید
2. لینک را کپی کنید
3. در مرورگر دیگر یا کاربر دیگر، لینک را باز کنید
4. به گروه بپیوندید

### ✅ 9. حذف برای همه
- [x] حذف پیام فقط برای خود
- [x] حذف پیام برای همه (با مجوز)

**تست:**
1. یک پیام ارسال کنید
2. از منوی پیام، "حذف" را انتخاب کنید
3. "حذف برای همه" را انتخاب کنید
4. بررسی کنید که پیام برای همه حذف شده است

### ✅ 10. تیک‌های خوانده شدن بهبود یافته
- [x] نمایش تیک تک (ارسال شده)
- [x] نمایش تیک دوتایی (خوانده شده)
- [x] نمایش تعداد خوانندگان در گروه

**تست:**
1. یک پیام ارسال کنید
2. تیک تک را ببینید
3. کاربر دیگر پیام را بخواند
4. تیک دوتایی را ببینید

### ✅ 11. اشتراک موقعیت
- [x] استفاده از موقعیت فعلی
- [x] وارد کردن دستی مختصات
- [x] نمایش نقشه در پیام
- [x] باز کردن در Google Maps

**تست:**
1. روی آیکون موقعیت کلیک کنید
2. "استفاده از موقعیت فعلی" را انتخاب کنید
3. موقعیت را ارسال کنید
4. روی نقشه کلیک کنید تا در Google Maps باز شود

### ✅ 12. پیش‌نمایش خودکار لینک
- [x] تشخیص خودکار لینک در متن
- [x] دریافت پیش‌نمایش لینک
- [x] نمایش پیش‌نمایش

**تست:**
1. یک لینک در پیام بفرستید
2. پیش‌نمایش خودکار را ببینید

### ✅ 13. مدیریت مخاطبین
- [x] افزودن مخاطب
- [x] حذف مخاطب
- [x] لیست مخاطبین
- [x] شروع چت از مخاطبین

**تست:**
1. به صفحه "مخاطبین" بروید
2. یک مخاطب اضافه کنید
3. از مخاطبین چت شروع کنید

### ✅ 14. جستجوی پیام
- [x] جستجو در چت فعلی
- [x] نمایش نتایج
- [x] رفتن به پیام پیدا شده

**تست:**
1. در صفحه چت، روی آیکون جستجو کلیک کنید
2. یک کلمه جستجو کنید
3. روی نتیجه کلیک کنید تا به پیام بروید

### ✅ 15. ارسال مجدد پیام
- [x] انتخاب چت‌های مقصد
- [x] ارسال به چند چت

**تست:**
1. روی یک پیام کلیک کنید
2. "ارسال مجدد" را انتخاب کنید
3. چت‌های مقصد را انتخاب کنید
4. پیام را ارسال کنید

## تست‌های Backend

### تست API Routes

```bash
# تست احراز هویت
POST /api/auth/register
POST /api/auth/login

# تست کاربران
GET /api/users/search?q=test
POST /api/users/:id/block
GET /api/users/blocked/list
POST /api/users/:id/contact
GET /api/users/contacts/list

# تست چت‌ها
GET /api/chats
POST /api/chats
POST /api/chats/:id/archive
POST /api/chats/:id/mute
POST /api/chats/:id/invite-link
POST /api/chats/join/:code

# تست پیام‌ها
GET /api/messages/:chatId
POST /api/messages
DELETE /api/messages/:id (با deleteForEveryone)
POST /api/messages/:id/reaction

# تست استوری
GET /api/stories
POST /api/stories
POST /api/stories/:id/view

# تست آپلود
POST /api/upload
```

## تست Socket Events

```javascript
// تست اتصال
socket.emit('join:chat', { chatId })

// تست ارسال پیام
socket.emit('message:send', { chatId, content, type })

// تست تایپ
socket.emit('message:typing', { chatId, isTyping })

// تست خوانده شدن
socket.emit('message:read', { messageId, chatId })

// تست رویدادها
socket.on('message:new', (message) => {})
socket.on('message:typing', (data) => {})
socket.on('user:online', (data) => {})
```

## نکات مهم

1. **نوتیفیکیشن‌ها**: نیاز به مجوز مرورگر دارند
2. **موقعیت**: نیاز به مجوز موقعیت دارد
3. **میکروفون**: نیاز به مجوز میکروفون دارد
4. **فایل‌ها**: باید در پوشه `backend/uploads` ذخیره شوند
5. **Socket**: باید به درستی متصل باشد

## مشکلات احتمالی و راه‌حل

1. **نوتیفیکیشن کار نمی‌کند**: مجوز مرورگر را بررسی کنید
2. **موقعیت کار نمی‌کند**: HTTPS یا localhost لازم است
3. **آپلود فایل خطا می‌دهد**: پوشه uploads را بررسی کنید
4. **Socket متصل نمی‌شود**: URL و توکن را بررسی کنید




